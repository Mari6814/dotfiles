# ~/.bash_profile: executed by bash(1) for login shells.

# Shortcut to .local dir
export LOCAL="$HOME/.local"

# Exit if $LOCAL not set
[ -z "$LOCAL" ] && echo "LOCAL not set in bash_profile" >&2

# Mark bash profile as sourced
export SOURCED="$BASH_SOURCE:$SOURCED"

# Add /bin inside of $LOCAL to path
[ -d "$LOCAL/bin" ] && export PATH="$LOCAL/bin:$PATH"

# Load local python, node, neovim, go installations
for dirname in python node nvim go; do
    [ -d "$LOCAL/$dirname/bin" ] && export PATH="$LOCAL/$dirname/bin:$PATH"
done

# Set the npm package install dir
if command -v npm &> /dev/null; then
    export NPM_PREFIX="$LOCAL/npm"
    if [ ! "$(npm config get prefix)" == "$NPM_PREFIX" ]; then
        echo "npm is installed: Setting install directory to $NPM_PREFIX" >&2
        npm config set prefix "$NPM_PREFIX"
    fi
    export PATH="$(npm config get prefix)/bin:$PATH"
    export PATH="./npm_modules/bin:$PATH"
fi

# Load the machine-local .bash_profile
# Load local .bash_profile last because neither of the other two should depend on anything in here
[ -f "$LOCAL/bash_profile" ] && source "$LOCAL/bash_profile"

# Just link the bash profile to .bashrc
# Link .bashrc second because it may depend on the login setup of
# the .bash_profile or .profile files
[ -f ~/.bashrc ] && source ~/.bashrc
